---
title: P7913 [CSP-S 2021] 廊桥分配
tags: [C++]
---
[原题链接](https://www.luogu.com.cn/problem/P7913)

代码+注释：

```cpp
/*
声明：本题为订正代码 
题目：洛谷中难度绿题 P7913 [CSP-S 2021] 廊桥分配
时间复杂度：O(n^2logn)
*/ 
#include<bits/stdc++.h>
using namespace std;
const int maxn=1e5;
long long n,m1,m2,ans=-999999;
struct plane
{
	long long l,r;//l表示到达时间，r表示离开时间
}a[maxn],b[maxn];
long long ans1[maxn],ans2[maxn];
bool cmp(plane x,plane y)
{
	return x.l<y.l;
}
vector<long long> maxplane(long long m1)
{
	for(int i=1;i<=m1;i++)
	{
		cin>>a[i].l>>a[i].r;
	}
	sort(a+1,a+1+m1,cmp);
	set<long long>s;//存储可用廊桥编号（1-n） 
	set<pair<long long,long long>>t;//存储飞机的离开时间&占用的廊桥编号 
	vector<long long>ans(1e5+1);//函数计算结果 
	for(int i=1;i<=n;i++)
	{
		s.insert(i);
	}//初始化，往s中塞1-n，表示所有廊桥都可用 
	for(int i=1;i<=m1;i++)
	{
		//现在时间是a[i].l
		while(!t.empty()&&a[i].l>(*t.begin()).first)//（注：(*t.begin()).first指的是离开的时间）
		{
			//离开 
			s.insert((*t.begin()).second);//飞机离开，添加一个可用的廊桥（注：(*t.begin()).second指的是占用的廊桥编号）
			t.erase(t.begin());//将这个离开的飞机的到达时间删除 
		}
		if(!s.empty())//如果还有廊桥可用 
		{
			//停靠 
			long long id=*s.begin();
			s.erase(id);//飞机到达，最小的廊桥被占，删除一个可用的廊桥 
			t.insert({a[i].r,id});//将到达时间&廊桥编号塞入t中
			ans[id]++;//飞机到达，停靠在编号最小的廊桥
		}	
	}
	for(int i=1;i<=n;i++)
	{
		ans[i]+=ans[i-1];
	}//对ans进行前缀和 
	return ans;
}
int main()
{
	cin>>n>>m1>>m2;
	vector<long long>ans1=maxplane(m1); 
	vector<long long>ans2=maxplane(m2);
	for(int i=0;i<=n;i++)
	{
		ans=max(ans,ans1[i]+ans2[n-i]);
	}
	cout<<ans<<endl;
} 
```
